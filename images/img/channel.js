/* Date: 2017-07-03T16:35:08Z Path: js/bin/channel/channel.js */
define("presale.tpl",function(){return Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,n){var i,l,s=t.helperMissing,o="function",r=this.escapeExpression,d=this.lambda;return'<div class="pop_left_sorts" activity_id="'+r((l=null!=(l=t.id||(null!=e?e.id:e))?l:s,typeof l===o?l.call(e,{name:"id",hash:{},data:n}):l))+'"><div class="img_box"><img src="'+r(d(null!=(i=null!=e?e.image:e)?i.new_pre_pic:i,e))+'" alt="'+r((l=null!=(l=t.name||(null!=e?e.name:e))?l:s,typeof l===o?l.call(e,{name:"name",hash:{},data:n}):l))+'" class="pic"/><div class="buyer_box">'+r((l=null!=(l=t.name||(null!=e?e.name:e))?l:s,typeof l===o?l.call(e,{name:"name",hash:{},data:n}):l))+'</div></div><div class="name_box clearfix"><span class="zhe">'+r((l=null!=(l=t.discountHtml||(null!=e?e.discountHtml:e))?l:s,typeof l===o?l.call(e,{name:"discountHtml",hash:{},data:n}):l))+'</span><p class="logo"><img src="'+r(d(null!=(i=null!=e?e.image:e)?i.brand:i,e))+'" alt="'+r((l=null!=(l=t.name||(null!=e?e.name:e))?l:s,typeof l===o?l.call(e,{name:"name",hash:{},data:n}):l))+'" /></p></div><a class="remind_box" href="'+r((l=null!=(l=t.url||(null!=e?e.url:e))?l:s,typeof l===o?l.call(e,{name:"url",hash:{},data:n}):l))+"?from=pop_home_coming_"+r((l=null!=(l=t.id||(null!=e?e.id:e))?l:s,typeof l===o?l.call(e,{name:"id",hash:{},data:n}):l))+"_pos"+r((l=null!=(l=t.presaleIndex||(null!=e?e.presaleIndex:e))?l:s,typeof l===o?l.call(e,{name:"presaleIndex",hash:{},data:n}):l))+'" target="_blank" rel="nofollow"></a></div>\n'},useData:!0})}),define("onsale.tpl",function(){return Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,n){var i,l,s=this.lambda,o=this.escapeExpression,r=t.helperMissing,d="function";return'<div class="pop_left_sorts"><div class="left_sorts_rank"><p class="logo"><img src="'+o(s(null!=(i=null!=e?e.image:e)?i.brand:i,e))+'" alt="'+o((l=null!=(l=t.name||(null!=e?e.name:e))?l:r,typeof l===d?l.call(e,{name:"name",hash:{},data:n}):l))+'" width="160" height="80" /></p><p class="notice tit">'+o((l=null!=(l=t.index_main_title||(null!=e?e.index_main_title:e))?l:r,typeof l===d?l.call(e,{name:"index_main_title",hash:{},data:n}):l))+'</p><p class="zhe">\n            '+o((l=null!=(l=t.discountHtml||(null!=e?e.discountHtml:e))?l:r,typeof l===d?l.call(e,{name:"discountHtml",hash:{},data:n}):l))+'\n        </p><p class="notice">'+o((l=null!=(l=t.start_date||(null!=e?e.start_date:e))?l:r,typeof l===d?l.call(e,{name:"start_date",hash:{},data:n}):l))+"-"+o((l=null!=(l=t.end_date||(null!=e?e.end_date:e))?l:r,typeof l===d?l.call(e,{name:"end_date",hash:{},data:n}):l))+'</p></div><div class="left_img_box"><img src="'+o(s(null!=(i=null!=e?e.image:e)?i.os_middle_pic:i,e))+'" alt="'+o((l=null!=(l=t.name||(null!=e?e.name:e))?l:r,typeof l===d?l.call(e,{name:"name",hash:{},data:n}):l))+'" class="pic" />\n        '+o((l=null!=(l=t.icon_png||(null!=e?e.icon_png:e))?l:r,typeof l===d?l.call(e,{name:"icon_png",hash:{},data:n}):l))+'\n    </div><div class="buyer_box"><div class="time_box" diff="'+o((l=null!=(l=t.diff_time||(null!=e?e.diff_time:e))?l:r,typeof l===d?l.call(e,{name:"diff_time",hash:{},data:n}):l))+'"></div><div class="tit">'+o((l=null!=(l=t.name||(null!=e?e.name:e))?l:r,typeof l===d?l.call(e,{name:"name",hash:{},data:n}):l))+'</div></div><a href="'+o((l=null!=(l=t.url||(null!=e?e.url:e))?l:r,typeof l===d?l.call(e,{name:"url",hash:{},data:n}):l))+"?from=pop_home_show_"+o((l=null!=(l=t.onsaleIndex||(null!=e?e.onsaleIndex:e))?l:r,typeof l===d?l.call(e,{name:"onsaleIndex",hash:{},data:n}):l))+"&dsrabt="+o((l=null!=(l=t.dsrabt||(null!=e?e.dsrabt:e))?l:r,typeof l===d?l.call(e,{name:"dsrabt",hash:{},data:n}):l))+'" target="_blank" rel="nofollow" class="onsale_link"><div class="onsale_link_bg"></div><div class="coin png"></div></a></div>\n'},useData:!0})}),define("ajax_loading",["onsale.tpl","presale.tpl"],function(e,t,a){"use strict";var n,i=e("onsale.tpl"),l=e("presale.tpl"),s=50,o=0,r=0,d=0,c=window.__pageType__||"",p=function(){return $.ajax({url:"/pop/ajax_onsale?type="+c+"&offset="+s+"&pagesize=30",dataType:"json",success:function(e){e?(s=e.lastindex,e.end&&(x.loadEnd(),r||e.list.length||$("#pop_center_onsale").hide())):r||$("#pop_center_onsale").hide(),r++}})},u=function(){return $.ajax({url:"/pop/ajax_presale?type="+c+"&offset="+o+"&pagesize=36",dataType:"json",success:function(e){e?(o=e.lastindex,e.end&&(n.loadEnd(),d||e.list.length||$("#pop_center_coming").hide())):d||$("#pop_center_coming").hide(),d++}})},m=function(e){for(var t=e.list,a=0,n=t.length;a<n;a++){var i,l=t[a];i=l.is_hwg?" pop_hwg":l.is_new?" new":l.is_end?" end":"",l.icon_png=i?new Handlebars.SafeString('<span class="corns'+i+'"></span>'):"",l.discountHtml=h(l),l.diff_time=l.end_time-JM.SERVER_TIME}return t},_=function(e){for(var t=e.list,a=0,n=t.length;a<n;a++){var i=t[a];i.discountHtml=h(i)}return t},h=function(e){Handlebars.registerHelper("discountHtml",function(){var e=this.sale_promotion_word;return new Handlebars.SafeString(e)})},f=$("#pop_hot .pop_left_sorts").length,v=function(e){return f++,e.onsaleIndex=f,e.dsrabt=window.__dsrABT__,Handlebars.compilePlus(i,e)},b=0,g=function(e){return b++,e.presaleIndex=b,Handlebars.compilePlus(l,e)},w=function(){n=new Jumei.ui.ScrollLoader("#popComing",{load:u,create:g,serialize:_,cells:12})},y=function(e){return window.popTimerCounter?window.popTimerCounter.add(e,window.timeOpt):window.popTimerCounter=new Jumei.ui.TimeCounter($(".time_box"),window.timeOpt)};if(window.__popTotal__>50){var x=new Jumei.ui.ScrollLoader("#popOnsale",{load:p,create:v,serialize:m,cells:10}),T=0;x.on("createafter",function(){var e=this.__o__.target,t=e.find("div.time_box").slice(T);T+=10,t.length&&y(t)}).on("createend",function(){w()})}else $("#pop_center_onsale").hide(),w()}),define("brand_trailer",function(e,t,a){"use strict";var n={init:function(e,t){var a=this;a.act_panle=t,e.delegate(".bt_brandlogo","mouseenter",function(e){var t=$(this),n={brand_id:t.attr("brand_id"),bid:t.attr("bid"),is_brand:t.attr("data-isBrand"),activity_id:t.attr("activity_id"),left:t.offset().left,top:t.offset().top,target:e.target};t.addClass("bl-hover"),a.clearLeaveTimer(),a.showActivity(n)}),e.delegate(".bt_brandlogo","mouseleave",function(){$(this).removeClass("bl-hover"),a.hideActivity(),a.clearEnterTimer()}),t.hover(function(){a.clearLeaveTimer()},function(){a.hideActivity()})},showActivity:function(e){var t,a=this,n=e.target;t="div"==n.nodeName.toLowerCase()?n.data:n.parentNode.data,a.enterTimer=setTimeout(function(){a.originalHtml(e),t?a.initActivityHtml(t):a.ajaxForData(e.brand_id,e);var n=e.left-330;a.act_panle.is(":visible")?a.act_panle.animate({left:n+"px",top:e.top+"px"},100):a.act_panle.css({left:n,top:e.top}).show()},150)},ajaxForData:function(e,t){var a=this;$.ajax({url:"/pop/ajax_get_activity_info",data:{id:e},dataType:"jsonp"}).then(function(e){var n=t.target;"div"==n.nodeName.toLowerCase()?n.data=e:n.parentNode.data=e,a.initActivityHtml(e)})},originalHtml:function(e){var t="true"===e.is_brand?"":"hide",a='<div class="pic"><img src="" width="310" height="200"><div class="trans_bg '+t+'"></div><div class="trans_con '+t+'"><a href="http://pop.'+JM.SITE_MAIN_TOPLEVELDOMAINNAME+"/story/"+e.bid+"_"+e.activity_id+'.html" target="_blank">品牌介绍<span class="arrow-right"></span></a></div></div><div class="bt_act_bottom"><div class="name_title"></div><div class="zhe"></div></div>';this.act_panle.html(a).hide()},initActivityHtml:function(e){var t=this.act_panle,a=e.data,n=a.sale_promotion_word;t.find("img").attr("src",a.middle_pic),t.find(".name_title").text(a.title),t.find(".zhe").html(n),t.show()},hideActivity:function(){var e=this;this.leaveTimer=setTimeout(function(){e.act_panle.html("").hide()},150)},clearLeaveTimer:function(){this.leaveTimer&&clearTimeout(this.leaveTimer)},clearEnterTimer:function(){this.enterTimer&&clearTimeout(this.enterTimer)}};({container:$("#J_brandTrailer"),tabs:$("#J_bt_tab"),will_content:$("#J_bt_activity"),init:function(){this.initTab(),n.init(this.container,this.will_content)},initTab:function(){var e=this.container,t=this.tabs.find("span"),a=this.tabs.find(".line"),n=t.eq(0),i=e.find(".bt_tab_content"),l=this;n.addClass("cur").attr("loaded","true"),a.css("left",n.position().left+5).show(),l.showTab(i.eq(0),!0),t.bind("mouseenter",function(){var e=$(this);e.addClass("cur").siblings().removeClass("cur"),a.animate({left:e.position().left+5},100);var t=e.index(),n=i.eq(t),s="true"!==e.attr("loaded");l.showTab(n,s),e.attr("loaded","true")})},showTab:function(e,t){if(t){var a=e.find(".bt_con"),n=a.find("textarea").val();a.html(n),this.slide(e)}e.show().siblings().hide()},slide:function(e){var t=e.find(".bt_con"),a=e.find(".slideup"),n=e.find(".slidedown"),i=$(".bt_brandlogo",e).length,l=57*Math.ceil(i/2),s=1,o=Math.ceil(l/741)||1,r=this;this.container.offset().top;this.SetSlideBtnStatus(s,o,a,n),a.click(function(){return s>1&&(t.animate({"margin-top":"+=741"},300),s--,r.SetSlideBtnStatus(s,o,a,n)),!1}),n.click(function(){return s<o&&(t.animate({"margin-top":"-=741"},300),s++,r.SetSlideBtnStatus(s,o,a,n)),!1})},SetSlideBtnStatus:function(e,t,a,n){e==t&&n.addClass("slide-dis").removeClass("slidedown-enable"),1==e&&a.addClass("slide-dis").removeClass("slideup-enable"),e<t&&n.addClass("slidedown-enable").removeClass("slide-dis"),e>1&&a.addClass("slideup-enable").removeClass("slide-dis")}}).init()}),define("channel_main",["brand_trailer","ajax_loading"],function(e){"use strict";var t={init:function(){e("brand_trailer"),t.lazyload(),t.timeCounter(),e("ajax_loading"),t.sortsHover(),this.bannerSilder()},lazyload:function(){new Jumei.ui.Lazyload($("#pop_hot img"),{attrName:"original"})},timeCounter:function(){window.timeOpt={format:'<span class="corn"></span>&nbsp;剩余  <span>DD</span>天<span>HH</span>时<span>MM</span>分<span>SS</span>秒',dtime:1e3,onStart:function(){this.$target.html(this.html)},onEnd:function(){this.$target.siblings().html(""),this.$target.html("已结束")}},window.popTimerCounter=new Jumei.ui.TimeCounter($(".time_box"),window.timeOpt)},sortsHover:function(){$(document).delegate(".pop_left_sorts","mouseenter",function(){$(this).addClass("pop_sorts_hover")}).delegate(".pop_left_sorts","mouseleave",function(){$(this).removeClass("pop_sorts_hover")})},bannerSilder:function(){$("#pop_top_banner").length>0&&($("#pop_top_banner").hasClass("home_foucs")?new Jumei.ui.HtmlSlidePlayer("#pop_top_banner",{autosize:1,fontsize:12,time:5e3,slidearrow:!1}):new Jumei.ui.Switchable("#pop_top_banner",{effects:"slideX",imglazyload:!0,nav:!1}))}};t.init()}),seajs.use(["app","channel_main"],function(){var e="http://cart."+JM.SITE_MAIN_TOPLEVELDOMAINNAME+"/i/cart/ajax_add_to_cart";new Jumei.app.iBar({addCartAjaxUrl:e})});